<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="529px" preserveAspectRatio="none" style="width:1434px;height:529px;background:#FFFFFF;" version="1.1" viewBox="0 0 1434 529" width="1434px" zoomAndPan="magnify"><defs><filter height="300%" id="f1b4exqrep4ztv" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1b4exqrep4ztv)" height="135.6641" style="stroke:#000000;stroke-width:2.0;" width="919" x="173" y="86.4297"/><rect fill="#FFFFFF" height="60.2656" style="stroke:none;stroke-width:1.0;" width="919" x="173" y="161.8281"/><rect fill="#FFFFFF" filter="url(#f1b4exqrep4ztv)" height="103.3984" style="stroke:#000000;stroke-width:2.0;" width="1247.5" x="173" y="278.2266"/><rect fill="#FFFFFF" height="44.1328" style="stroke:none;stroke-width:1.0;" width="1247.5" x="173" y="337.4922"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="34" x2="34" y1="40.2969" y2="486.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="250" x2="250" y1="40.2969" y2="486.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="969" x2="969" y1="40.2969" y2="486.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1176" x2="1176" y1="40.2969" y2="486.0234"/><rect fill="#FEFECE" filter="url(#f1b4exqrep4ztv)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="55" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="12" y="24.9951">Client</text><rect fill="#FEFECE" filter="url(#f1b4exqrep4ztv)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="55" x="5" y="485.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="12" y="505.0186">Client</text><rect fill="#FEFECE" filter="url(#f1b4exqrep4ztv)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="131" x="183" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="190" y="24.9951">BasicTileService</text><rect fill="#FEFECE" filter="url(#f1b4exqrep4ztv)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="131" x="183" y="485.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="190" y="505.0186">BasicTileService</text><rect fill="#FEFECE" filter="url(#f1b4exqrep4ztv)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="221" x="857" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="207" x="864" y="24.9951">GoogleSatelliteImageService</text><rect fill="#FEFECE" filter="url(#f1b4exqrep4ztv)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="221" x="857" y="485.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="207" x="864" y="505.0186">GoogleSatelliteImageService</text><rect fill="#FEFECE" filter="url(#f1b4exqrep4ztv)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="164" x="1092" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="1099" y="24.9951">CompressionHandler</text><rect fill="#FEFECE" filter="url(#f1b4exqrep4ztv)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="164" x="1092" y="485.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="1099" y="505.0186">CompressionHandler</text><polygon fill="#A80036" points="238.5,67.4297,248.5,71.4297,238.5,75.4297,242.5,71.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="34.5" x2="244.5" y1="71.4297" y2="71.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="41.5" y="66.3638">getTile([tileRequest])</text><path d="M173,86.4297 L242,86.4297 L242,93.4297 L232,103.4297 L173,103.4297 L173,86.4297 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="135.6641" style="stroke:#000000;stroke-width:2.0;" width="919" x="173" y="86.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="188" y="99.4966">par</text><polygon fill="#A80036" points="957.5,120.6953,967.5,124.6953,957.5,128.6953,961.5,124.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="250.5" x2="963.5" y1="124.6953" y2="124.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="296" x="257.5" y="119.6294">getTile(tileCoordinates, ifNoneMatch, format)</text><polygon fill="#A80036" points="261.5,149.8281,251.5,153.8281,261.5,157.8281,257.5,153.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="255.5" x2="968.5" y1="153.8281" y2="153.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="267.5" y="148.7622">[Tile HTTP response]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="173" x2="1092" y1="162.8281" y2="162.8281"/><polygon fill="#A80036" points="957.5,180.9609,967.5,184.9609,957.5,188.9609,961.5,184.9609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="250.5" x2="963.5" y1="184.9609" y2="184.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="309" x="257.5" y="179.895">getCopyright(viewPort, ifNoneMatch, language)</text><polygon fill="#A80036" points="261.5,210.0938,251.5,214.0938,261.5,218.0938,257.5,214.0938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="255.5" x2="968.5" y1="214.0938" y2="214.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="267.5" y="209.0278">[Copyright HTTP response]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="250.5" x2="292.5" y1="250.2266" y2="250.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="292.5" x2="292.5" y1="250.2266" y2="263.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="251.5" x2="292.5" y1="263.2266" y2="263.2266"/><polygon fill="#A80036" points="261.5,259.2266,251.5,263.2266,261.5,267.2266,257.5,263.2266" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="439" x="257.5" y="245.1606">mergeResponses([Tile HTTP response], [Copyright HTTP response])</text><path d="M173,278.2266 L237,278.2266 L237,285.2266 L227,295.2266 L173,295.2266 L173,278.2266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="103.3984" style="stroke:#000000;stroke-width:2.0;" width="1247.5" x="173" y="278.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="188" y="291.2935">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="315" x="252" y="290.437">[[Tile HTTP response].status = '304 not modified']</text><line style="stroke:#A80036;stroke-width:1.0;" x1="250.5" x2="292.5" y1="316.4922" y2="316.4922"/><line style="stroke:#A80036;stroke-width:1.0;" x1="292.5" x2="292.5" y1="316.4922" y2="329.4922"/><line style="stroke:#A80036;stroke-width:1.0;" x1="251.5" x2="292.5" y1="329.4922" y2="329.4922"/><polygon fill="#A80036" points="261.5,325.4922,251.5,329.4922,261.5,333.4922,257.5,329.4922" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="612" x="257.5" y="311.4263">mergeHeaders([Tile HTTP response], [Copyright HTTP response]) =&gt; [Merged HTTP response]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="173" x2="1420.5" y1="338.4922" y2="338.4922"/><line style="stroke:#A80036;stroke-width:1.0;" x1="250.5" x2="292.5" y1="360.625" y2="360.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="292.5" x2="292.5" y1="360.625" y2="373.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="251.5" x2="292.5" y1="373.625" y2="373.625"/><polygon fill="#A80036" points="261.5,369.625,251.5,373.625,261.5,377.625,257.5,373.625" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="705" x="257.5" y="355.5591">mergeHeadersWithCopyright([Tile HTTP response], [Copyright HTTP response]) =&gt; [Merged HTTP response]</text><path d="M974,345.9922 L974,370.9922 L1401,370.9922 L1401,355.9922 L1391,345.9922 L974,345.9922 " fill="#FBFB77" filter="url(#f1b4exqrep4ztv)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1391,345.9922 L1391,355.9922 L1401,355.9922 L1391,345.9922 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="406" x="980" y="363.0591">if copyright is found, then is added to [Merged HTTP response]</text><polygon fill="#A80036" points="1164,405.7578,1174,409.7578,1164,413.7578,1168,409.7578" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="250.5" x2="1170" y1="409.7578" y2="409.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="372" x="257.5" y="404.6919">compress(format, qualityLevel, [Merged HTTP response])</text><polygon fill="#A80036" points="261.5,434.8906,251.5,438.8906,261.5,442.8906,257.5,438.8906" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="255.5" x2="1175" y1="438.8906" y2="438.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="267.5" y="433.8247">compressed resource</text><polygon fill="#A80036" points="45.5,464.0234,35.5,468.0234,45.5,472.0234,41.5,468.0234" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="39.5" x2="249.5" y1="468.0234" y2="468.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="51.5" y="462.9575">[Compressed HTTP response]</text><!--MD5=[e446b99179ccda7ddcc452b068fa434a]
@startuml BasicTileService.getTile

!$tileRequest = "[tileRequest]"
!$tile_http_resp = "[Tile HTTP response]"
!$copyright_http_resp = "[Copyright HTTP response]"
!$merged_http_resp = "[Merged HTTP response]"
!$compressed_http_resp = "[Compressed HTTP response]"

Client -> BasicTileService: getTile($tileRequest)

par
    BasicTileService -> GoogleSatelliteImageService: getTile(tileCoordinates, ifNoneMatch, format)
    GoogleSatelliteImageService - -> BasicTileService: $tile_http_resp
else
    BasicTileService -> GoogleSatelliteImageService: getCopyright(viewPort, ifNoneMatch, language)
    GoogleSatelliteImageService - -> BasicTileService: $copyright_http_resp
end

BasicTileService -> BasicTileService: mergeResponses($tile_http_resp, $copyright_http_resp)

alt $tile_http_resp.status = '304 not modified'
    BasicTileService -> BasicTileService: mergeHeaders($tile_http_resp, $copyright_http_resp) => $merged_http_resp
else
    BasicTileService -> BasicTileService: mergeHeadersWithCopyright($tile_http_resp, $copyright_http_resp) => $merged_http_resp
    note right: if copyright is found, then is added to $merged_http_resp
end

BasicTileService -> CompressionHandler: compress(format, qualityLevel, $merged_http_resp)
CompressionHandler - -> BasicTileService: compressed resource
BasicTileService - -> Client: $compressed_http_resp

@enduml

@startuml BasicTileService.getTile


Client -> BasicTileService: getTile([tileRequest])

par
    BasicTileService -> GoogleSatelliteImageService: getTile(tileCoordinates, ifNoneMatch, format)
    GoogleSatelliteImageService - -> BasicTileService: [Tile HTTP response]
else
    BasicTileService -> GoogleSatelliteImageService: getCopyright(viewPort, ifNoneMatch, language)
    GoogleSatelliteImageService - -> BasicTileService: [Copyright HTTP response]
end

BasicTileService -> BasicTileService: mergeResponses([Tile HTTP response], [Copyright HTTP response])

alt [Tile HTTP response].status = '304 not modified'
    BasicTileService -> BasicTileService: mergeHeaders([Tile HTTP response], [Copyright HTTP response]) => [Merged HTTP response]
else
    BasicTileService -> BasicTileService: mergeHeadersWithCopyright([Tile HTTP response], [Copyright HTTP response]) => [Merged HTTP response]
    note right: if copyright is found, then is added to [Merged HTTP response]
end

BasicTileService -> CompressionHandler: compress(format, qualityLevel, [Merged HTTP response])
CompressionHandler - -> BasicTileService: compressed resource
BasicTileService - -> Client: [Compressed HTTP response]

@enduml

PlantUML version 1.2021.11(Sat Oct 02 15:26:11 CEST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>