<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="414px" preserveAspectRatio="none" style="width:788px;height:414px;background:#FFFFFF;" version="1.1" viewBox="0 0 788 414" width="788px" zoomAndPan="magnify"><defs><filter height="300%" id="fb86lks6elrcm" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="150" x="317.25" y="28.708">sessionContext()</text><rect fill="#FFFFFF" filter="url(#fb86lks6elrcm)" height="119.5313" style="stroke:#000000;stroke-width:2.0;" width="764.5" x="10" y="163.5156"/><rect fill="#FFFFFF" filter="url(#fb86lks6elrcm)" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="501.5" x="20" y="187.6484"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="59" x2="59" y1="75.25" y2="371.3125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="389.5" x2="389.5" y1="75.25" y2="371.3125"/><rect fill="#FEFECE" filter="url(#fb86lks6elrcm)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="55" x="30" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="37" y="59.9482">Client</text><rect fill="#FEFECE" filter="url(#fb86lks6elrcm)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="55" x="30" y="370.3125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="37" y="390.3076">Client</text><rect fill="#FEFECE" filter="url(#fb86lks6elrcm)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="240" x="267.5" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="226" x="274.5" y="59.9482">CachingSessionContextProvider</text><rect fill="#FEFECE" filter="url(#fb86lks6elrcm)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="240" x="267.5" y="370.3125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="226" x="274.5" y="390.3076">CachingSessionContextProvider</text><polygon fill="#A80036" points="377.5,102.3828,387.5,106.3828,377.5,110.3828,381.5,106.3828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="59.5" x2="383.5" y1="106.3828" y2="106.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306" x="66.5" y="101.3169">sessionContext(String language, String format)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="389.5" x2="431.5" y1="135.5156" y2="135.5156"/><line style="stroke:#A80036;stroke-width:1.0;" x1="431.5" x2="431.5" y1="135.5156" y2="148.5156"/><line style="stroke:#A80036;stroke-width:1.0;" x1="390.5" x2="431.5" y1="148.5156" y2="148.5156"/><polygon fill="#A80036" points="400.5,144.5156,390.5,148.5156,400.5,152.5156,396.5,148.5156" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="372" x="396.5" y="130.4497">getSessionKey(language, format, false) =&gt; [sessionKey]</text><path d="M10,163.5156 L74,163.5156 L74,170.5156 L64,180.5156 L10,180.5156 L10,163.5156 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="119.5313" style="stroke:#000000;stroke-width:2.0;" width="764.5" x="10" y="163.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="176.5825">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="390" x="89" y="175.7261">[getSessionKey method thrown WebClientResponseException]</text><path d="M20,187.6484 L84,187.6484 L84,194.6484 L74,204.6484 L20,204.6484 L20,187.6484 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="501.5" x="20" y="187.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="35" y="200.7153">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="146" x="99" y="199.8589">[sessionKey is expired]</text><polygon fill="#A80036" points="70.5,221.9141,60.5,225.9141,70.5,229.9141,66.5,225.9141" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="64.5" x2="388.5" y1="225.9141" y2="225.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="76.5" y="220.8481">throw WebClientResponseException</text><line style="stroke:#A80036;stroke-width:1.0;" x1="389.5" x2="431.5" y1="262.0469" y2="262.0469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="431.5" x2="431.5" y1="262.0469" y2="275.0469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="390.5" x2="431.5" y1="275.0469" y2="275.0469"/><polygon fill="#A80036" points="400.5,271.0469,390.5,275.0469,400.5,279.0469,396.5,275.0469" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="366" x="396.5" y="256.981">getSessionKey(language, format, true) =&gt; [sessionKey]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="389.5" x2="431.5" y1="311.1797" y2="311.1797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="431.5" x2="431.5" y1="311.1797" y2="324.1797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="390.5" x2="431.5" y1="324.1797" y2="324.1797"/><polygon fill="#A80036" points="400.5,320.1797,390.5,324.1797,400.5,328.1797,396.5,324.1797" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308" x="396.5" y="306.1138">Create new [sessionContext] with [sessionKey]</text><polygon fill="#A80036" points="70.5,349.3125,60.5,353.3125,70.5,357.3125,66.5,353.3125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="64.5" x2="388.5" y1="353.3125" y2="353.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="76.5" y="348.2466">[sessionContext]</text><!--MD5=[c21cd513ef6e7f1b92ca02da5ebadca7]
@startuml CachingSessionContextProvider.sessionContext

!$sessionKey = "[sessionKey]"
!$sessionToken = "[sessionToken]"
!$cacheKey = "[cacheKey]"
!$cache_1st_level = "[1st level cache]"
!$sessionContext = "[sessionContext]"

title sessionContext()

Client -> CachingSessionContextProvider: sessionContext(String language, String format)
CachingSessionContextProvider -> CachingSessionContextProvider: getSessionKey(language, format, false) => $sessionKey
alt getSessionKey method thrown WebClientResponseException
    alt sessionKey is expired
        CachingSessionContextProvider - -> Client: throw WebClientResponseException
    end
    CachingSessionContextProvider -> CachingSessionContextProvider: getSessionKey(language, format, true) => $sessionKey
end
CachingSessionContextProvider -> CachingSessionContextProvider: Create new $sessionContext with $sessionKey
CachingSessionContextProvider - -> Client: $sessionContext

@enduml

@startuml CachingSessionContextProvider.sessionContext


title sessionContext()

Client -> CachingSessionContextProvider: sessionContext(String language, String format)
CachingSessionContextProvider -> CachingSessionContextProvider: getSessionKey(language, format, false) => [sessionKey]
alt getSessionKey method thrown WebClientResponseException
    alt sessionKey is expired
        CachingSessionContextProvider - -> Client: throw WebClientResponseException
    end
    CachingSessionContextProvider -> CachingSessionContextProvider: getSessionKey(language, format, true) => [sessionKey]
end
CachingSessionContextProvider -> CachingSessionContextProvider: Create new [sessionContext] with [sessionKey]
CachingSessionContextProvider - -> Client: [sessionContext]

@enduml

PlantUML version 1.2021.11(Sat Oct 02 15:26:11 CEST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>